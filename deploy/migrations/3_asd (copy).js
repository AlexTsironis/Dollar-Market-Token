const StableAMM = artifacts.require("StableAMM");
const USD = artifacts.require("USD");
const StableToken = artifacts.require("StableToken");

const creator = "0x40c0B3f63459c4301338DFCf7899a0Ec93481f02";

const fs = require('fs');


async function saveLog(amm, counter){

    let usd_balance = await amm.balanceUSD();
    let tok_balance = await amm.balanceStable();
    let treasury = await amm.treasuryUSD();
    let rate = await amm.swapAMM(0, 1000000);
    rate = rate / 1000000;

    let data = '\n'+counter+'\t'+usd_balance+'\t'+tok_balance+'\t'+treasury+'\t'+rate;
    console.log(data);
    
    fs.appendFileSync('exp1.txt', data)

}

module.exports = async function(deployer) {

	const actualUSD = await USD.deployed();
	const actualStableToken = await StableToken.deployed();
	const actualAMM = await StableAMM.deployed();

    let quantity = '100000000000000000000000';


    function sleep(ms){
        return new Promise(r => setTimeout(r, ms));
    }

    let txn = [['6673532366752624511718758', '0'], ['0', '2886467774326813969974318'], ['0', '195727103332630991872841'], ['483846538905175571151241', '0'], ['0', '527473840965013366027750'], ['0', '210294767055725613748974'], ['0', '445995569646553042069343'], ['363157000300811594179122', '0'], ['0', '39811829251614539480282'], ['0', '27900424284800416491066'], ['176792187961274826632277', '0'], ['1131960604041537186667379', '0'], ['0', '1377761053766476254112952'], ['219410049706506024898919', '0'], ['0', '19560067620396918698216'], ['0', '179839906372123005258617'], ['0', '5424393062362325788471'], ['0', '5432492048419675926467'], ['98461370013571932616645', '0'], ['0', '455221781946420113026012'], ['0', '346929773639556666203494'], ['0', '310220000807336579766500'], ['471360178436602103609677', '0'], ['530581042889473931107584', '0'], ['0', '187420614093595215368591'], ['23566090556572553728261', '0'], ['116931765239003258461755', '0'], ['0', '23164254188867435630986'], ['0', '126771654525244958213758'], ['707934671669241870716630', '0'], ['0', '326881701552463536533867'], ['120751401950847405723082', '0'], ['0', '331408148992078849789673'], ['0', '261379289175568103485607'], ['0', '651384155192839413007461'], ['139412862253083522753419', '0'], ['0', '177211373017194160073552'], ['0', '292698035905595354224130'], ['79203876494452248519277', '0'], ['74751553353116437910400', '0'], ['132750292162344272742060', '0'], ['0', '353148412972226023487201'], ['0', '233404135335483004840882'], ['0', '215032471020607469866106'], ['19576360375298203219959', '0'], ['0', '99779123681398928835724'], ['0', '763211044545433730000920'], ['0', '14457098359409070029519'], ['0', '18137651514555574802195'], ['0', '293050149087722404205756'], ['0', '37045209889311994745963'], ['0', '159404113056272134784090'], ['0', '280555822051309739378503'], ['320614270813103854242535', '0'], ['193088672337569676486374', '0'], ['347569645955899059908633', '0'], ['461633232899160932882412', '0'], ['0', '332836180889956466248551'], ['486075623038170293607725', '0'], ['0', '211365950001882816390179'], ['51778248893872864630161', '0'], ['0', '774435303047972641415288'], ['59776890398100965396829', '0'], ['0', '99383316872968934486933'], ['53955648573952453518174', '0'], ['0', '35476230318369220309700'], ['0', '833266063001435323382530'], ['286712783218240523795558', '0'], ['0', '205448595711405884416612'], ['11270263256558368032235', '0'], ['300345822844227804626371', '0'], ['312390220702337459341356', '0'], ['113137248658740810069716', '0'], ['237379847231538822005189', '0'], ['183935112463339549403983', '0'], ['61361796782873430534974', '0'], ['0', '301174404696486467707683'], ['17278045066184868233749', '0'], ['306261281660782068270582', '0'], ['369930555459893691716114', '0'], ['0', '166694314963204588435318'], ['309491317744118237010231', '0'], ['45991318040952650429544', '0'], ['342575021761288951129380', '0'], ['176949416694115213983628', '0'], ['335124041030150156415096', '0'], ['0', '21498223837837811697977'], ['0', '230338587208835099355633'], ['238994402694613836938683', '0'], ['797263462086444484000312', '0'], ['0', '284276846261384512101773'], ['0', '183109247592205431429543'], ['495171227143269581154742', '0'], ['0', '46208438430171737109286'], ['178683881681276195377583', '0'], ['543411877185525094289214', '0'], ['0', '394187445957041317989642'], ['0', '81420562168605989776411'], ['150052545629047255893903', '0'], ['0', '55568945516335642582921'], ['329718969886141614733308', '0'], ['0', '134802827568200453092074'], ['214846627025500257658226', '0'], ['256450294964397768464540', '0'], ['31750086337369209165352', '0'], ['402966091935312853361552', '0'], ['0', '135479888537970612291037'], ['925185031591005442408618', '0'], ['0', '277446457932079721875040'], ['0', '30805676274681576840767'], ['393224164550606342421769', '0'], ['0', '485941414016235541194357'], ['0', '340742972403613416718789'], ['0', '710988508293136008392315'], ['907749663943813874671347', '0'], ['532883153990313798598541', '0'], ['1460149663380536240183693', '0'], ['366847232352879546514426', '0'], ['63783384343443807746777', '0'], ['0', '177169198450195569132304'], ['590536751812699061126609', '0'], ['807348875080679300997507', '0'], ['0', '1872953510486295518505825'], ['0', '564086673195451394087927'], ['666108158654989434609793', '0'], ['0', '262486137503725128329009'], ['597560823472771913290145', '0'], ['652770844185933754705715', '0'], ['0', '230129896115977605993857'], ['576104837368547152855598', '0'], ['291340985920683448804891', '0'], ['72435457260742363870974', '0'], ['784325798611681506973284', '0'], ['0', '23381917997803893374126'], ['0', '356867704484021938048171'], ['0', '319602714056705037194214'], ['228338568160288904603846', '0'], ['0', '147863280412346528225322'], ['183033107850177380988709', '0'], ['1032013014295535648643830', '0'], ['0', '1510570155323740319241525'], ['37249966212394522584526', '0'], ['0', '2423562840505017943772605'], ['147822651462530008657521', '0'], ['61398562921799712147701', '0'], ['0', '51782873142432119829685'], ['0', '86935313738382727127509'], ['527721646477721659378768', '0'], ['0', '1161891614408482720447826'], ['72209403584093166648026', '0'], ['0', '131196257614963690780856'], ['300092491526541568589168', '0'], ['16021434949142200035243', '0'], ['0', '412485457665607036340554'], ['0', '1003038617587375960023173'], ['355461011427651284611022', '0'], ['55111880845177430569838', '0'], ['185767292488393669570646', '0'], ['198856153837290662736592', '0'], ['943940892743704959585775', '0'], ['0', '851108183879397078639716'], ['770065074667442488650409', '0'], ['221886849240654607056319', '0'], ['268639101481478215488981', '0'], ['35804608539887720994904', '0'], ['0', '229440700682945173388651'], ['0', '125074099374354875479665'], ['0', '172017049740763158613982'], ['0', '408419795497565744394944'], ['162506268742865015784085', '0'], ['0', '383804981906140100817331'], ['50182410149515053394035', '0'], ['0', '243666182440228631475629'], ['10581607488796610565785', '0'], ['96423004268378645324224', '0'], ['59101286889957633843945', '0'], ['78502725599414760090286', '0'], ['0', '423982070295539796629393'], ['8031776673526962215829', '0'], ['0', '299954523024005447686234'], ['0', '110450917571731595676038'], ['0', '108189283929247801944082'], ['0', '15777282430052206914172'], ['192227953352833219174739', '0'], ['0', '133325224694739824238091'], ['0', '217548479548102933831049'], ['1884024709395059534776', '0'], ['0', '231500142609083047525820'], ['266494289447891722341615', '0'], ['541975322422502897811124', '0'], ['1378709070527255469254555', '0'], ['1001629910707086922189328', '0'], ['693551922275210375382997', '0'], ['0', '283356800609352384614287'], ['0', '697769092469571399657242'], ['0', '82874321359019580709081'], ['0', '23471309552478839402395'], ['0', '457430298148189181089826'], ['0', '439113414984175158883341'], ['0', '1110695036389148908206747'], ['0', '71454505450620970887914'], ['40698317897578308210418', '0'], ['401437230320921433655364', '0'], ['0', '207260048358564257899543'], ['39497242538241794457299', '0'], ['271817495227750512437565', '0'], ['190258458912531948245992', '0'], ['0', '262057667835819156895146'], ['0', '93509257110777057439636'], ['0', '540949627381644756190229'], ['42429394641668923409920', '0'], ['0', '553375602994229793267288'], ['98615514003268220455798', '0'], ['275678613015269399727092', '0'], ['76554480847681105619763', '0'], ['0', '315999989152652686983075']];

    
    //await saveLog(actualAMM,0);
    for(let counter = 212; counter<txn.length; counter++){
        try{
            await actualAMM.swap(txn[counter][0], txn[counter][1]);
            await saveLog(actualAMM,counter);
            console.log(counter);
            //await sleep(5000);
        } catch (error){} 
        
    }
    

};
